<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="jin">
	<typeAlias alias="openmeet" type="openmeet.OpenmeetModel" />
	<typeAlias alias="comments" type="comments.CommentsModel" />
	<typeAlias alias="members" type="members.MembersModel" />
	<typeAlias alias="board" type="board.BoardModel" />

<!-- openmeet query -->
	<sql id="om_select_all">
		select * from openmeet
	</sql>

	<sql id="om_where_o_no">
		where o_no=#o_no#
	</sql>
	
	<sql id="om_orderby">
		order by o_no desc
	</sql>

	<select id="openmeet_select_all" resultClass="openmeet">
		<include refid="om_select_all" />
		<include refid="om_orderby"/>
	</select>
	
	<select id="openmeet_select_one" resultClass="openmeet" parameterClass="int">
		<include refid="om_select_all"/>
		<include refid="om_where_o_no"/>
	</select>
	
<!-- comments query -->
	<sql id="cmt_select_all">
		select * from comments
	</sql>

	<sql id="cmt_where_c_no">
		where c_no=#c_no#
	</sql>
	<sql id="cmt_where_c_my_no">
		where c_my_no=#c_my_no#
	</sql>
	<sql id="cmt_where_o_no">
		where o_no=#o_no#
	</sql>
	<sql id="cmt_where_b_no">
		where b_no=#b_no#
	</sql>
	<sql id="cmt_where_m_no">
		where bd_no=#m_no#
	</sql>
	
	<sql id="cmt_orderby">
		order by c_no desc
	</sql>

	<select id="comments_select_all_c_my_no" resultClass="comments"  parameterClass="int">
		<include refid="cmt_select_all" />
		<include refid="cmt_where_c_my_no"/>
		<include refid="cmt_orderby"/>
	</select>
	
	<select id="comments_select_all_o_no" resultClass="comments"  parameterClass="int">
		<include refid="cmt_select_all" />
		<include refid="cmt_where_o_no"/>
		<include refid="cmt_orderby"/>
	</select>
	
	<select id="comments_select_all_b_no" resultClass="comments"  parameterClass="int">
		<include refid="cmt_select_all" />
		<include refid="cmt_where_b_no"/>
		<include refid="cmt_orderby"/>
	</select>
	
	<select id="comments_select_all_m_no" resultClass="comments"  parameterClass="int">
		<include refid="cmt_select_all" />
		<include refid="cmt_where_m_no"/>
		<include refid="cmt_orderby"/>
	</select>
	
	<insert id="comments_insert" parameterClass="comments">
		insert into comments values(comments_seq.nextval,#c_name#,#c_content#,#c_date#,#c_my_no#,#o_no#,#b_no#,#m_no#)
	</insert>

<!-- board query -->
	<sql id="bd_select_all">
		select * from board
	</sql>
	
	<sql id="bd_where_b_no">
		where b_no=#b_no#
	</sql>
	<sql id="bd_where_b_kind">
		where b_kind=#b_kind#
	</sql>
	<sql id="bd_where_search_b_subject">
		where b_subject like '%'||#searchWord#||'%'
	</sql>
	<sql id="bd_where_search_b_subject_content">
		where b_subject like '%'||#searchWord#||'%' or b_content like '%'||#searchWord#||'%'
	</sql>
	<sql id="bd_where_search_b_name">
		where b_name like '%'||#searchWord#||'%'
	</sql>
	
	<sql id="bd_orderby">
		order by b_no desc
	</sql>
	
	<select id="board_select_all" resultClass="board">
		<include refid="bd_select_all"/>
		<include refid="bd_orderby"/>
	</select>
	
	<select id="board_select_one" resultClass="board" parameterClass="int">
		<include refid="bd_select_all"/>
		<include refid="bd_where_b_no"/>
	</select>
	
	<update id="board_update_readcount" parameterClass="int">
		update board set b_readcount=b_readcount+1 
		<include refid="bd_where_b_no"/>
	</update>
	
	<select id="board_search_b_subject_select_all" resultClass="board" parameterClass="String">
		<include refid="bd_select_all"/>
		<include refid="bd_where_search_b_subject"/>
		<include refid="bd_orderby"/>
	</select>
	
	<select id="board_search_b_subject_content_select_all" resultClass="board"  parameterClass="String">
		<include refid="bd_select_all"/>
		<include refid="bd_where_search_b_subject_content"/>
		<include refid="bd_orderby"/>
	</select>
	
	<select id="board_search_b_name_select_all" resultClass="board"  parameterClass="String">
		<include refid="bd_select_all"/>
		<include refid="bd_where_search_b_name"/>
		<include refid="bd_orderby"/>
	</select>
	
	<insert id="board_insert" parameterClass="board">
		insert into board values(board_seq.nextval,#b_kind#,#b_name#,#b_email#,#b_company#,#b_category#,#b_subject#,#b_content#,#b_fav_area#,#b_fav_field#,#b_payment#,#b_date#,#b_readcount#)
	</insert>
	
<!-- member query -->
	<sql id="mem_select_all">
		select * from members
	</sql>
	
	<sql id="mem_where_m_no">
		where m_no=#m_no#
	</sql>
	
	<sql id="mem_where_m_email">
		where m_email=#m_email#
	</sql>
	
	<select id="members_select_one_where_m_no" parameterClass="int" resultClass="members">
		<include refid="mem_select_all"/>
		<include refid="mem_where_m_no"/>
	</select>

	<select id="members_select_one_where_m_email" parameterClass="String" resultClass="members">
		<include refid="mem_select_all"/>
		<include refid="mem_where_m_email"/>
	</select>
	
</sqlMap>