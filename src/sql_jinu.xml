<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap>
	<typeAlias alias="openmeet" type="openmeet.OpenmeetModel" />
	<typeAlias alias="comments" type="comments.CommentsModel" />

	<resultMap class="openmeet" id="openmeet_rm">
		<result property="o_no" column="o_no" />
		<result property="o_name" column="o_name" />
		<result property="o_email" column="o_email" />
		<result property="o_phone" column="o_phone" />
		<result property="o_company" column="o_company" />
		<result property="o_category" column="o_category" />
		<result property="o_subject" column="o_subject" />
		<result property="o_content" column="o_content" />
		<result property="o_rep_img" column="o_rep_img" />
		<result property="o_content_img" column="o_content_img" />
		<result property="o_m_sdate" column="o_m_sdate" />
		<result property="o_m_edate" column="o_m_edate" />
		<result property="o_r_sdate" column="o_r_sdate" />
		<result property="o_r_edate" column="o_r_edate" />
		<result property="o_title" column="o_title" />
		<result property="o_addr" column="o_addr" />
		<result property="o_total_pnum" column="o_total_pnum" />
		<result property="o_current_pnum" column="o_current_pnum" />
		<result property="o_payment" column="o_payment" />
		<result property="o_date" column="o_date" />
		<result property="o_readcount" column="o_readcount" />
	</resultMap>
	
	<resultMap class="comments" id="comments_rm">
		<result property="c_no" column="c_no"/>
		<result property="c_name" column="c_name"/>
		<result property="c_content" column="c_content"/>
		<result property="c_date" column="c_date"/>
		<result property="c_my_no" column="c_my_no"/>
		<result property="o_no" column="o_no"/>
		<result property="bt_no" column="bt_no"/>
		<result property="bd_no" column="bd_no"/>
	</resultMap>

<!-- openmeet query -->
	<sql id="om_select_all">
		select * from openmeet
	</sql>

	<sql id="om_where_o_no">
		where o_no=#o_no#
	</sql>

	<select id="openmeet_select_all" resultMap="openmeet_rm">
		<include refid="om_select_all" />
		order by o_no desc
	</select>
	
	<select id="openmeet_select_one" resultMap="openmeet_rm" parameterClass="int">
		<include refid="om_select_all"/>
		<include refid="om_where_o_no"/>
	</select>
	
<!-- comments query -->
	<sql id="cmt_select_all">
		select * from comments
	</sql>

	<sql id="cmt_where_c_no">
		where c_no=#c_no#
	</sql>
	<sql id="cmt_where_c_my_no">
		where c_my_no=#c_my_no#
	</sql>
	<sql id="cmt_where_o_no">
		where o_no=#o_no#
	</sql>
	<sql id="cmt_where_bt_no">
		where bt_no=#bt_no#
	</sql>
	<sql id="cmt_where_bd_no">
		where bd_no=#bd_no#
	</sql>

	<select id="comments_select_all_c_my_no" resultMap="comments_rm"  parameterClass="int">
		<include refid="cmt_select_all" />
		<include refid="cmt_where_c_my_no"/>
		order by c_no desc
	</select>
	
	<select id="comments_select_all_o_no" resultMap="comments_rm"  parameterClass="int">
		<include refid="cmt_select_all" />
		<include refid="cmt_where_o_no"/>
		order by c_no desc
	</select>
	
	<select id="comments_select_all_bt_no" resultMap="comments_rm"  parameterClass="int">
		<include refid="cmt_select_all" />
		<include refid="cmt_where_bt_no"/>
		order by c_no desc
	</select>
	
	<select id="comments_select_all_bd_no" resultMap="comments_rm"  parameterClass="int">
		<include refid="cmt_select_all" />
		<include refid="cmt_where_bd_no"/>
		order by c_no desc
	</select>
	
	<insert id="comments_insert_openmeet" parameterClass="comments">
		insert into comments(c_no,c_name,c_content,c_date,o_no) values(comments_seq.nextval,#c_name#,#c_content#,#c_date#,#o_no#)
	</insert>
	
</sqlMap>